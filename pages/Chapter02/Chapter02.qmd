---
title: "Probability, Entropy and Inference"
date: 03/07/2005
date-format: "DD MMMM YYYY"
date-modified: last-modified
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

```{r}
#| label: imports-and-functions-r
#| code-summary: "Imports and Functions - R"
#| output: false

library(tidyverse)
library(reticulate)
library(ggpubr)
library(ggthemes)
library(kableExtra)
```


---

### Exercise 2.2

::: {.callout-note}
Are the random variables X and Y in the joint ensemble of figure 2.2 independent?
:::

Yes, because the marginal probabilities of monograms marginalized over the joint ensemble on probabilities for all possible bigrams $P(x,y)$ equal exactly the probability of monograms themselves $P(x) = P(y)$.


### Exercise 2.4

::: {.callout-note}
An urn contains $K$ balls, of which $B$ are black and $W = K − B$ are white. Fred draws a ball at random from the urn and replaces it, $N$ times.

a) What is the probability distribution of the number of times a black ball is drawn, $nB$?
a) What is the expectation of $nB$? What is the variance of $nB$? What is the standard deviation of $nB$? Give numerical answers for the cases $N = 5$ and $N = 400$, when $B = 2$ and $K = 10$.
:::

Since this is a sampling with replacement, each draw is independent and can be considered a Bernoulli trial with outcome black or white.

The distribution of aggregate outcomes of a fixed number of Bernoulli trials (i.e. how many of the drawn balls are expected to be black or white) with a constant rate of success follows a binomial distribution with _pdf_:

$$
f(n,k,p) = {n \choose k}p^{k}(1-p)^{n-k}
$$

Where $n$ is the number of trials, $k$ is the number of successes (black balls drawn) and $p$ is the success rate $B/K$.

#### Expectation and Mean

The mean is simply $np$ as each draw we have probability $p$ of drawing a black ball.
The mode (expectation) is the mean rounded to the nearest integer.

#### Variance

This is a bit more complex and requires a few tricks. Lets start with the general definition of variance

$$
\mathbb{V} = \mathbb{E}[X^2] - \mathbb{E}[X]
$$ {#eq-general-variance}

As we introduced above, $\mathbb{E}[X] = np$.


Solving $\mathbb{E}[X^2]$ directly will be too complex so we resort to factorizing it down to a combination of lower order factorial moments. Big words to say: _something that is equivalent but lower power_.

$$
\mathbb{E}[X^2] = \mathbb{E}[X(X - 1)] + \mathbb{E}[X]
$$

This is nice because $\mathbb{E}[X]$ is again simply the mean $np$.

The first term is akin to having two trial $X$ and $X-1$ which means it can be simplified to

$$
\mathbb{E}[X(X - 1)] = n(n-1)p^2
$$

Substituting all the terms to @eq-general-variance we get

$$
\begin{split}
\mathbb{V} &= \mathbb{E}[X^2] - \mathbb{E}[X] \\
&= n(n-1)p^2 + np - n^2p^2 \\
&= \cancel{n^2p^2} - np^2 + np - \cancel{n^2p^2} \\
&= np(1-p)
\end{split}
$$

And the standard deviation is $\sigma = \sqrt{\mathbb{V}} = \sqrt{np(1-p)}$.

#### Numerical answers

- $N = 5$ the expectation is `r round(5*(2/10))` and the standard deviation is `r 5*(2/10)*(1 - (2/10))`
- $N = 400$ the expectation is `r round(400*(2/10))` and the standard deviation is `r 400*(2/10)*(1 - (2/10))`

```{r}
#| fig-cap: Binomial distributions for drawing 10 and 100 balls with replacement
#| label: fig-2.4-binomials-sampling-with-replacement
#| fig-subcap:
#|   - "For 5 draws"
#|   - "For 400 draws"
#| layout-ncol: 1

n_black <- 2
n_balls <- 10
p_black <- n_black / n_balls

for (n_draws in c(5, 400)) {
  black_balls <- c(0:n_draws)
  p <- data.frame(black_balls = black_balls) %>%
    mutate(prob_success = dbinom(black_balls, n_draws, p_black)) %>%
    ggplot(aes(black_balls, prob_success)) +
    geom_col(fill = "black", alpha = .2) +
    geom_line(color = "black") +
    ggthemes::theme_few()
  print(p)
}
```


### Exercise 2.4

::: {.callout-note}
An urn contains $K$ balls, of which $B$ are black and $W = K−B$ are white. We define the fraction $fB≡B/K$.
Fred draws N times from the urn, exactly as in exercise 2.4, obtaining $nB$ blacks, and computes the quantity
$$
z = \frac{(n_B-f_{B}N)^2}{Nf_B(1-f_B)}
$$
What is the expectation of $z$? In the case $N = 5$ and $fB = 1/5$,
what is the probability distribution of $z$? What is the probability that $z < 1$?
:::

::: {.callout-tip appearance=default}
Compare z with the quantities computed in the previous exercise.
:::
